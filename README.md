# griflim
Spectrogram Inversion with the Griffin and Lim Algorithm

This code features two implementations of the Griffin and Lim algorithm for reconstruction of a signal given a magnitude-only STFT.  The original algorithm is implemented in griffinlim.m, while an updated version for realtime applications (Zhu et al 2007) is implemented in rtisi2.m.  What follows is a brief description of the included scripts:

glimdemo.m --> Accepts a sound specified by 'filename,' performs an STFT using stft.m, strips the STFT of its phase, and reconstructs using griffinlim.m. Plays and saves resulting sound as output.wav, generates plots to compare analysis and original signal, and to track the squared errors reduction over synthesis iterations.

glimwin.m --> Defines window of length L --as specified in Griffin and Lim (1984)--  that has the property of summing to 1 when squared and overlap-added at a rate of OL.

griffinlim.m --> Implementation of the Griffin and Lim algorithm (1984) for phase reconstruction. Accepts magnitude-only STFT X (expecting spectral frames that are 2x's zero-padded, as generated by stft.m).  Will iterate for 'numIters' iterations.  Suggested/default synthesis 'overlap' is 4 (i.e. hop size is 1/4th of the expected window size).  Setting 'initrand' to a nonzero value will use random phase (rather than 0 phase) for the first iteration of synthesis.  This is off by default.

LSEEMSTFT.m --> Reconstructs a signal 'x' from a given STFT representation 'X' and hop size 'hop'. As part of the LSEE algorithm, signal is re-windowed in synthesis then normalized by a sum of squared windows over time.  However, the use of a self-normalizing window is assumed (see glimwin.m).  If the user would like to provide their own window, set 'normalize' to a non-zero value.

rtisi2.m --> % Implementation of the Griffin and Lim algorithm for phase reconstruction with Real-Time implementation (RTISI) update by Zhu et. al (2007). 'X' = input spectrogram (magnitude only STFT) - each frame is assumed to be 2-times buffered (zero padded) and centered.  The included script stft.m may be used to accomplish this. 'numIts' = number of synthesis iterations per frame.  10 is usually more than sufficient.

rtisi2demo.m --> Sample implementation of rtisi2.m. Accepts a sound specified by 'filename,' performs an STFT using stft.m, strips the STFT of its phase, and reconstructs using rtisi2.m.  Generates plots to compare estimate and original signal.  The second half of this script may be used to demonstrate how estimate error reduces with iterations.  Be careful, as it takes a long time to run.

stft.m --> Generates spectrogram of given input signal 'x', using window length 'window' defined by user, and hop size 'hop'.  Each stft frame is generated from a windowed, 2x's zero-padded, and shifted signal (for correct phase estimation).

Many thanks are due to Malcolm Slaney's ComplexSpectrogram.m and InvertSpectrogram.m

Thank you for your interest.

// Max Henry
// Department of Music Technology
// McGill University
// Montreal, Qc
// December 13, 2019.
